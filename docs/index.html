<!--
 Copyright (c) 2017 AT&T Intellectual Property. All rights reserved.

 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

       http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.
-->
<html>
<head>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; background-color: #f8f8f8; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
pre, code { background-color: #f8f8f8; }
code > span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code > span.dt { color: #204a87; } /* DataType */
code > span.dv { color: #0000cf; } /* DecVal */
code > span.bn { color: #0000cf; } /* BaseN */
code > span.fl { color: #0000cf; } /* Float */
code > span.ch { color: #4e9a06; } /* Char */
code > span.st { color: #4e9a06; } /* String */
code > span.co { color: #8f5902; font-style: italic; } /* Comment */
code > span.ot { color: #8f5902; } /* Other */
code > span.al { color: #ef2929; } /* Alert */
code > span.fu { color: #000000; } /* Function */
code > span.er { color: #a40000; font-weight: bold; } /* Error */
code > span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #000000; } /* Constant */
code > span.sc { color: #000000; } /* SpecialChar */
code > span.vs { color: #4e9a06; } /* VerbatimString */
code > span.ss { color: #4e9a06; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #000000; } /* Variable */
code > span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code > span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code > span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code > span.ex { } /* Extension */
code > span.at { color: #c4a000; } /* Attribute */
code > span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code > span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
</style>
<link rel="stylesheet" href="mktechdocs.css"/>
<title>MkTechDocs Installation and Usage Guide v0.9</title>
</head>
<body>
<div id="wrapper">
<div id="header">
<h1 style="font-size: 300%; margin-bottom: 0;">MkTechDocs</h1>
<p style="font-size: 80%">A framework for collating and transforming markdown</p>

</div><!-- header -->
<div id="navbar">
<div id="TOC">
<ul>
<li><a href="#introduction"><span class="toc-section-number">1</span> Introduction</a><ul>
<li><a href="#what-is-it"><span class="toc-section-number">1.1</span> What is it?</a></li>
<li><a href="#features"><span class="toc-section-number">1.2</span> Features</a></li>
<li><a href="#can-i-see-an-example"><span class="toc-section-number">1.3</span> Can I see an example?</a></li>
<li><a href="#supported-architectures"><span class="toc-section-number">1.4</span> Supported architectures</a></li>
<li><a href="#downloading-and-setting-up-your-environment"><span class="toc-section-number">1.5</span> Downloading and setting up your environment</a></li>
</ul></li>
<li><a href="#the-basics"><span class="toc-section-number">2</span> The basics</a><ul>
<li><a href="#markdown"><span class="toc-section-number">2.1</span> Markdown</a></li>
<li><a href="#creating-a-new-project"><span class="toc-section-number">2.2</span> Creating a new project</a></li>
<li><a href="#mktechdocs-projects"><span class="toc-section-number">2.3</span> MkTechDocs projects</a><ul>
<li><a href="#master-document"><span class="toc-section-number">2.3.1</span> Master document</a></li>
<li><a href="#sub-documents"><span class="toc-section-number">2.3.2</span> Sub documents</a><ul>
<li><a href="#images"><span class="toc-section-number">2.3.2.1</span> Images</a></li>
</ul></li>
</ul></li>
</ul></li>
<li><a href="#building-your-document"><span class="toc-section-number">3</span> Building your document</a><ul>
<li><a href="#multiple-configurations"><span class="toc-section-number">3.1</span> Multiple configurations</a></li>
<li><a href="#pre--and-post-build-activities"><span class="toc-section-number">3.2</span> Pre- and post-build activities</a></li>
</ul></li>
<li><a href="#building-your-document-with-docker"><span class="toc-section-number">4</span> Building your document with Docker</a></li>
<li><a href="#configuration"><span class="toc-section-number">5</span> Configuration</a><ul>
<li><a href="#simple-configuration"><span class="toc-section-number">5.1</span> Simple configuration</a></li>
<li><a href="#advanced-configuration"><span class="toc-section-number">5.2</span> Advanced configuration</a></li>
</ul></li>
<li><a href="#title-pages"><span class="toc-section-number">6</span> Title pages</a><ul>
<li><a href="#title-metadata-block"><span class="toc-section-number">6.1</span> Title metadata block</a></li>
<li><a href="#yaml-metadata-block"><span class="toc-section-number">6.2</span> YAML metadata block</a></li>
<li><a href="#templates"><span class="toc-section-number">6.3</span> Templates</a></li>
</ul></li>
<li><a href="#useful-blocks"><span class="toc-section-number">7</span> Useful Blocks</a><ul>
<li><a href="#comment"><span class="toc-section-number">7.1</span> Comment</a></li>
<li><a href="#include"><span class="toc-section-number">7.2</span> Include</a></li>
<li><a href="#include-code"><span class="toc-section-number">7.3</span> Include-code</a></li>
<li><a href="#note"><span class="toc-section-number">7.4</span> Note</a></li>
<li><a href="#plantuml"><span class="toc-section-number">7.5</span> Plantuml</a></li>
<li><a href="#tip"><span class="toc-section-number">7.6</span> Tip</a></li>
</ul></li>
<li><a href="#document-links"><span class="toc-section-number">8</span> Document links</a><ul>
<li><a href="#pandoc-links"><span class="toc-section-number">8.1</span> Pandoc links</a></li>
<li><a href="#mktechdocs-links"><span class="toc-section-number">8.2</span> MkTechDocs links</a></li>
</ul></li>
<li><a href="#python-templates"><span class="toc-section-number">9</span> Python templates</a><ul>
<li><a href="#the-template"><span class="toc-section-number">9.1</span> The template</a></li>
<li><a href="#the-renderer"><span class="toc-section-number">9.2</span> The renderer</a></li>
<li><a href="#referencing-templates-in-include-blocks"><span class="toc-section-number">9.3</span> Referencing templates in include blocks</a></li>
<li><a href="#footer.html-header.html-and-landing.html-as-templates"><span class="toc-section-number">9.4</span> <code>footer.html</code>, <code>header.html</code>, and <code>landing.html</code> as templates</a></li>
<li><a href="#escaping-curly-brackets"><span class="toc-section-number">9.5</span> Escaping curly brackets</a></li>
<li><a href="#for-more-information"><span class="toc-section-number">9.6</span> For more information</a></li>
</ul></li>
<li><a href="#managing-document-versions"><span class="toc-section-number">10</span> Managing document versions</a><ul>
<li><a href="#global_vars"><span class="toc-section-number">10.1</span> <code>global_vars</code></a></li>
</ul></li>
<li><a href="#incorporating-groovy-code-and-templates"><span class="toc-section-number">11</span> Incorporating Groovy code and templates</a><ul>
<li><a href="#installation-of-groovy-components"><span class="toc-section-number">11.1</span> Installation of groovy components</a><ul>
<li><a href="#environment"><span class="toc-section-number">11.1.1</span> Environment</a></li>
<li><a href="#testing-the-integration"><span class="toc-section-number">11.1.2</span> Testing the integration</a></li>
</ul></li>
<li><a href="#groovy-templates"><span class="toc-section-number">11.2</span> Groovy templates</a></li>
<li><a href="#groovy-classes"><span class="toc-section-number">11.3</span> Groovy classes</a></li>
<li><a href="#classpath"><span class="toc-section-number">11.4</span> <code>CLASSPATH</code></a></li>
</ul></li>
<li><a href="#team-documentation"><span class="toc-section-number">12</span> Team documentation</a><ul>
<li><a href="#case-study"><span class="toc-section-number">12.1</span> Case study</a></li>
<li><a href="#managing-git-commit-messages"><span class="toc-section-number">12.2</span> Managing git commit messages</a><ul>
<li><a href="#gitcommitdb"><span class="toc-section-number">12.2.1</span> GitCommitDB</a></li>
</ul></li>
</ul></li>
<li><a href="#download"><span class="toc-section-number">13</span> Download</a></li>
<li><a href="#setting-up-your-environment"><span class="toc-section-number">14</span> Setting up your environment</a><ul>
<li><a href="#running-the-dependencies-installation-script"><span class="toc-section-number">14.1</span> Running the dependencies installation script</a><ul>
<li><a href="#dependencies"><span class="toc-section-number">14.1.1</span> Dependencies</a></li>
</ul></li>
<li><a href="#testing-your-environment"><span class="toc-section-number">14.2</span> Testing your environment</a></li>
<li><a href="#a-note-about-titlesec"><span class="toc-section-number">14.3</span> A note about titlesec</a></li>
</ul></li>
<li><a href="#running-filters"><span class="toc-section-number">15</span> Running filters</a><ul>
<li><a href="#flt-comment-block.py"><span class="toc-section-number">15.1</span> <code>flt-comment-block.py</code></a></li>
<li><a href="#flt-comment.py"><span class="toc-section-number">15.2</span> <code>flt-comment.py</code></a></li>
<li><a href="#flt-decrement-header-1.py"><span class="toc-section-number">15.3</span> <code>flt-decrement-header-1.py</code></a></li>
<li><a href="#flt-decrement-header-2.py"><span class="toc-section-number">15.4</span> <code>flt-decrement-header-2.py</code></a></li>
<li><a href="#flt-decrement-header-3.py"><span class="toc-section-number">15.5</span> <code>flt-decrement-header-3.py</code></a></li>
<li><a href="#flt-decrement-header-4.py"><span class="toc-section-number">15.6</span> <code>flt-decrement-header-4.py</code></a></li>
<li><a href="#flt-decrement-header-5.py"><span class="toc-section-number">15.7</span> <code>flt-decrement-header-5.py</code></a></li>
<li><a href="#flt-get-includes.py"><span class="toc-section-number">15.8</span> <code>flt-get-includes.py</code></a></li>
<li><a href="#flt-include-code.py"><span class="toc-section-number">15.9</span> <code>flt-include-code.py</code></a></li>
<li><a href="#flt-include-doc-map.py"><span class="toc-section-number">15.10</span> <code>flt-include-doc-map.py</code></a></li>
<li><a href="#flt-include.py"><span class="toc-section-number">15.11</span> <code>flt-include.py</code></a></li>
<li><a href="#flt-increment-header-1.py"><span class="toc-section-number">15.12</span> <code>flt-increment-header-1.py</code></a></li>
<li><a href="#flt-increment-header-2.py"><span class="toc-section-number">15.13</span> <code>flt-increment-header-2.py</code></a></li>
<li><a href="#flt-increment-header-3.py"><span class="toc-section-number">15.14</span> <code>flt-increment-header-3.py</code></a></li>
<li><a href="#flt-increment-header-4.py"><span class="toc-section-number">15.15</span> <code>flt-increment-header-4.py</code></a></li>
<li><a href="#flt-increment-header-5.py"><span class="toc-section-number">15.16</span> <code>flt-increment-header-5.py</code></a></li>
<li><a href="#flt-notetip.py"><span class="toc-section-number">15.17</span> <code>flt-notetip.py</code></a></li>
<li><a href="#flt-plantuml.py"><span class="toc-section-number">15.18</span> <code>flt-plantuml.py</code></a></li>
<li><a href="#flt-strip-pages-from-links.py"><span class="toc-section-number">15.19</span> <code>flt-strip-pages-from-links.py</code></a></li>
<li><a href="#flt-template.py"><span class="toc-section-number">15.20</span> <code>flt-template.py</code></a></li>
</ul></li>
<li><a href="#scripts"><span class="toc-section-number">16</span> Scripts</a><ul>
<li><a href="#check_build_env.sh"><span class="toc-section-number">16.1</span> <code>check_build_env.sh</code></a></li>
<li><a href="#dec-headers.sh"><span class="toc-section-number">16.2</span> <code>dec-headers.sh</code></a></li>
<li><a href="#escape-jinja-brackets.sh"><span class="toc-section-number">16.3</span> <code>escape-jinja-brackets.sh</code></a></li>
<li><a href="#inc-headers.sh"><span class="toc-section-number">16.4</span> <code>inc-headers.sh</code></a></li>
<li><a href="#install_deps_1604_py.sh"><span class="toc-section-number">16.5</span> <code>install_deps_1604+_py.sh</code></a></li>
<li><a href="#install_deps_arch_py.sh"><span class="toc-section-number">16.6</span> <code>install_deps_arch_py.sh</code></a></li>
<li><a href="#install_deps_macos_py.sh"><span class="toc-section-number">16.7</span> <code>install_deps_macos_py.sh</code></a></li>
<li><a href="#mktechdocs"><span class="toc-section-number">16.8</span> <code>mktechdocs</code></a></li>
</ul></li>
<li><a href="#addendum"><span class="toc-section-number">17</span> Addendum</a><ul>
<li><a href="#understanding-the-build-process"><span class="toc-section-number">17.1</span> Understanding the build process</a></li>
<li><a href="#contact"><span class="toc-section-number">17.2</span> Contact</a></li>
</ul></li>
<li><a href="#document-change-log"><span class="toc-section-number">18</span> Document change log</a></li>
</ul>
</div><!-- TOC -->
</div><!-- sidebar -->
<div id="content">
<h1 id="introduction"><span class="header-section-number">1</span> Introduction</h1>
<h2 id="what-is-it"><span class="header-section-number">1.1</span> What is it?</h2>
<p><strong>MkTechDocs</strong> is an open framework for collating and transforming markdown. You can use it to manage complex technical documentation projects with dependencies, produce light documentation, or combine and transform existing Markdown files into a styled webpage or PDF document.</p>
<h2 id="features"><span class="header-section-number">1.2</span> Features</h2>
<ul>
<li>100% open source</li>
<li>No proprietary, hard-to-read, or hard-to-learn input formats or configuration syntaxes</li>
<li>Standardized to Markdown with Pandoc extensions, which is easy to learn and convertible
into many other formats</li>
<li>Shallow learning curve</li>
<li>Builds CSS-styled HTML, PDF, Microsoft Word, and markdown documents
from the same source documentation</li>
<li>Encourages modular document design</li>
<li>Flexible and extensible</li>
<li>Projects ideally suited for storing in git repositories, which means
documentation work can be distributed like source code</li>
<li>Python and Groovy/Java hooks provide easy access to pre-existing
code libraries</li>
<li>Jinja2 and Groovy template support is baked in for more complex documentation needs
Pandodc templates can be customized on a per-project basis</li>
<li>Agile and continuous-integration friendly</li>
</ul>
<h2 id="can-i-see-an-example"><span class="header-section-number">1.3</span> Can I see an example?</h2>
<p>You're looking at one!</p>
<h2 id="supported-architectures"><span class="header-section-number">1.4</span> Supported architectures</h2>
<p>MkTechDocs currently supports Arch and Ubuntu (16.04+,18.04+) Linux and macOS. It may work in Windows under Cygwin, MinGW, or Ubuntu Bash for Windows.</p>
<h2 id="downloading-and-setting-up-your-environment"><span class="header-section-number">1.5</span> Downloading and setting up your environment</h2>
<p>See the <a href="#download">Download</a> and <a href="#setting-up-your-environment">Setting up your environment</a> sections at the end of this document for more information.</p>
<h1 id="the-basics"><span class="header-section-number">2</span> The basics</h1>
<p>The easiest way to learn how to use MkTechDocs effectively is with a tutorial project. <a href="https://github.com/jsseidel/GettingStartedWithMkTechDocs">Here's one on GitHub</a>.</p>
<p>Unlike the comprehensive usage guide, the tutorial project uses a Docker image to build and provides a good overview of a MkTechDocs project without getting too far into the weeds.</p>
<h2 id="markdown"><span class="header-section-number">2.1</span> Markdown</h2>
<p>MkTechDocs uses Markdown exclusively, although support for additional syntaxes may be added in the future. More specifically, it uses standard Markdown syntax <a href="http://pandoc.org/MANUAL.html#pandocs-markdown">with Pandoc extensions</a>. In this documentation, assume that any file with a <code>.md</code> extension is a file that contains Markdown. Markdown is easy to learn, read, and edit and is easily transformable into a myriad of output formats. To use MkTechDocs effectively, take a few minutes to familiarize yourself with <a href="https://daringfireball.net/projects/markdown/syntax">Markdown syntax</a>.</p>
<h2 id="creating-a-new-project"><span class="header-section-number">2.2</span> Creating a new project</h2>
<p>To create a new MkTechDocs project, <code>cd</code> inside the directory where you want to create it and run <code>mktechdocs</code>. For example:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">mkdir</span> mynewproject
<span class="bu">cd</span> mynewproject
<span class="ex">mktechdocs</span> init</code></pre></div>
<p><code>mktechdocs</code> will create the following files in <code>mynewproject</code>:</p>
<table>
<colgroup>
<col width="19%" />
<col width="80%" />
</colgroup>
<thead>
<tr class="header">
<th>File Name</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>footer.html</code>*</td>
<td>Custom HTML content MkTechDocs should place in the footer area of HTML output.</td>
</tr>
<tr class="even">
<td><code>header.html</code>*</td>
<td>Custom HTML content MkTechDocs should place in the header area of HTML output.</td>
</tr>
<tr class="odd">
<td><code>landing.html</code>*</td>
<td>Custom HTML landing-page content MkTechDocs uses in index.html when creating multi-html-page output.</td>
</tr>
<tr class="even">
<td><code>master.md</code></td>
<td>A stub master document.</td>
</tr>
<tr class="odd">
<td><code>subdocument.md</code></td>
<td>An example subdocument that's included inside the master.</td>
</tr>
<tr class="even">
<td><code>mktechdocs.conf</code></td>
<td>Project configuration.</td>
</tr>
</tbody>
</table>
<p>* NOTE 1: Optional. If you don't need this HTML content, for example, if you're producing PDF content only, you can safely delete these files.</p>
<p>* NOTE 2: If you need more dynamic content in your header, footer, or main content, dates, database information, etc., please read the <a href="#footer.html-header.html-and-landing.html-as-templates"><code>footer.html</code>, <code>header.html</code>, and <code>landing.html</code> as templates section</a></p>
<h2 id="mktechdocs-projects"><span class="header-section-number">2.3</span> MkTechDocs projects</h2>
<h3 id="master-document"><span class="header-section-number">2.3.1</span> Master document</h3>
<p>MkTechDocs projects consist of a &quot;master&quot; document &#8212; a single markdown document that defines your project, always named <code>master.md</code>&#8212; and any number of sub documents. Building a master document is simple:</p>
<pre><code>```comment
Define one or more include blocks to include all the major subdocuments that
make up your project.
```
```{.include heading-level=0}
introduction.md
getting-started.md
more-things.md
the-end.md
```</code></pre>
<p>Note the <code>heading-level=0</code> attribute. This tells MkTechDocs that the current heading level at the point of the include block is '0'. This will result in each included document starting with heading level of 1, or &lt;H1&gt; in HTML parlance. If you want to keep all your heading-level ones in the master document, that's okay, too. Simply use <code>heading-level=1</code> when including subdocuments. More information on this follows.</p>
<h3 id="sub-documents"><span class="header-section-number">2.3.2</span> Sub documents</h3>
<p>Every sub document you include should start with a heading level of 1 (i.e. &lt;H1&gt;). MkTechDocs automatically increases the heading level of included documents (even multi-level recursive includes, where a document includes another document that includes another document, and so on). The heading-level adjustments will work provided that you give MkTechDocs a hint about the current heading level at the point of inclusion, as we have already seen:</p>
<pre><code>### A level three header

```{.include heading-level=3}
myincludeddoc.md
```</code></pre>
<p>Now, regardless of how many included documents appear in <code>myincludedoc.md</code> and in documents included in <em>those</em> documents, the heading levels should be consistent, provided you remember that all sub documents should start with a heading level of 1, as if they were a standalone document.</p>
<p class="tip"><b>Tip</b>: Creating every sub document such that it can exist on its own has the added benefit of allowing you to assemble different combinations of documents for different audiences. For example, you might want to build a small section of a much larger document as a standalone PDF.</p>

<h4 id="images"><span class="header-section-number">2.3.2.1</span> Images</h4>
<p>If you want to include images in your project document, include them inline using standard Markdown:</p>
<p>E.g.</p>
<pre><code>```
Please click to [the following link](images/smiley.png) to see a smiley.
    
Or let&#39;s include it inline with a title underneath:
 
![Smiley](images/smiley.png)
```</code></pre>
<p>And here's what the code above looks like after rendering:</p>
<hr />
<p>Please refer to <a href="images/smiley.png">the following link</a> to see a smiley.</p>
<p>Or let's include it inline with a title underneath:</p>
<div class="figure">
<img src="images/smiley.png" alt="Smiley" />
<p class="caption">Smiley</p>
</div>
<hr />
<p>Then, tell MkTechDocs where your images directory is in the <a href="#simple-configuration">configuration section</a> of your project makefile.</p>
<h1 id="building-your-document"><span class="header-section-number">3</span> Building your document</h1>
<p>To build your new project from scratch with the default configuration (a single CSS-styled HTML page with a navigation sidebar pinned to the left-hand side), simply do:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="ex">mktechdocs</span></code></pre></div>
<p>If no errors occur, your new <code>index.html</code> HTML page and CSS file should appear in <code>./myproject/myproject_pages</code>.</p>
<p>Here is the inline help:</p>
<pre><code>$ mktechdocs help
Usage: mtechdocs [help|clean|init]
  help : Display this help message
  clean: Remove temporary build files
  init : Create a new MkTechDocs project in the current directory

Usage: mtechdocs
  Builds the MkTechDocs project in the current directory. Assumes
  that a mktechdocs.conf file and master.md file are present.

Usage: mtechdocs &lt;config&gt; &lt;directory&gt;
  Builds the MkTechDocs project in the given directory using the
  given configuration.
$</code></pre>
<h2 id="multiple-configurations"><span class="header-section-number">3.1</span> Multiple configurations</h2>
<p>Note that a project can have as many configurations as necessary. For example, if you need to produce a PDF and styled webpage:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="ex">mktechdocs</span> config1.conf /Users/mylogin/myproject
<span class="ex">mktechdocs</span> config2.conf /Users/mylogin/myproject</code></pre></div>
<h2 id="pre--and-post-build-activities"><span class="header-section-number">3.2</span> Pre- and post-build activities</h2>
<p>Suppose you have a set of static documents as part of your documentation. You'll need to copy these to both the build and output directories in order for the images to appear inline.</p>
<p>Use the <code>BUILD_SCRIPT</code> <a href="#advanced-configuration">configuration</a> variable to provide the name of a script to run pre-build and post-build. The script should accept 3 arguments:</p>
<table style="width:83%;">
<colgroup>
<col width="15%" />
<col width="68%" />
</colgroup>
<thead>
<tr class="header">
<th>Argument #</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>The activity being performed. Possible values given by MkTechDocs are <code>pre</code> and <code>post</code>. These indicate that any pre- or post-build activies should take place.</td>
</tr>
<tr class="even">
<td>2</td>
<td>The full path to the output directory.</td>
</tr>
</tbody>
</table>
<p>Here's an example build script that copies a directory of images into the build and output directories when appropriate:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="co">#!/bin/bash</span>

<span class="va">ACTIVITY=$1</span>
<span class="va">OUT_DIR=$2</span>

<span class="kw">if [[</span> <span class="st">&quot;</span><span class="va">$1</span><span class="st">&quot;</span> <span class="ot">==</span> <span class="st">&quot;pre&quot;</span><span class="kw"> ]]</span> ; <span class="kw">then</span>
    <span class="bu">echo</span> <span class="st">&quot;Creating some new stuff in ./mystuff...&quot;</span>
<span class="kw">elif [[</span> <span class="st">&quot;</span><span class="va">$1</span><span class="st">&quot;</span> <span class="ot">==</span> <span class="st">&quot;post&quot;</span><span class="kw"> ]]</span> ; <span class="kw">then</span>
    <span class="bu">echo</span> <span class="st">&quot;Copying ./mystuff to </span><span class="va">$OUT_DIR</span><span class="st">...&quot;</span>
    <span class="fu">cp</span> -r ./mystuff <span class="va">$OUT_DIR</span>/.
<span class="kw">fi</span></code></pre></div>
<p>You don't need to worry about copying images to your output directory. Because images are often associated with documentation, MkTechDocs provides a <a href="#simple-configuration">configuration option</a> where you can specify the path to your the directory that holds your images.</p>
<h1 id="building-your-document-with-docker"><span class="header-section-number">4</span> Building your document with Docker</h1>
<p>MkTechDocs is a complex set of code and dependencies, so it can be difficult to set up to run locally. Fortunately, MkTechDocs is available as a Docker image on <a href="https://hub.docker.com/r/jsseidel/mktechdocs/">Docker Hub</a>: <code>jsseidel/mktechdocs</code>.</p>
<p>To use it, you need to have Docker installed. Then, building projects is relatively simple:</p>
<pre><code>docker run --rm -v /home/ubuntu/MyMkTechDocsProject:/project jsseidel/mktechdocs</code></pre>
<p>Here's the breakdown of the command:</p>
<p><code>--rm</code>: Remove the container after it exits. Otherwise, it will hang around in the <code>Exited</code> state, which can be useful if there were problems.</p>
<p><code>-v</code>: Create a volume and map <code>/home/ubuntu/MyMkTechDocsProject</code> <em>outside</em> the container to <code>/project</code> <em>inside</em> the container. <code>/project</code> is where the entry script inside the container looks for a project to build.</p>
<p><code>jsseidel/mktechdocs</code>: This is the docker image to use to run the container. Since no tag is specified (e.g. <code>jsseidel/mktechdocs:0.0.1</code>), docker will use the <code>latest</code> tag.</p>
<p>When you run it, an entry script inside the <code>mktechdocs</code> container will <code>cd</code> into <code>/project</code> and run <code>mktechdocs</code>. For this to work, your project must contain both a <code>mktechdocs.conf</code> and a <code>master.md</code> file.</p>
<h1 id="configuration"><span class="header-section-number">5</span> Configuration</h1>
<p>You configure MkTechDocs projects with variables contained in a configuration file in your project directory. By default, the name of this file is <code>mktechdocs.conf</code>, and if you choose to use this name, you won't have to provide the configuration file and directory when you run MkTechDocs.</p>
<h2 id="simple-configuration"><span class="header-section-number">5.1</span> Simple configuration</h2>
<p>For the majority of relatively simple documents and websites, the simple configuration options should suffice.</p>
<table>
<colgroup>
<col width="15%" />
<col width="30%" />
<col width="53%" />
</colgroup>
<thead>
<tr class="header">
<th>Variable Name</th>
<th>Possible Values</th>
<th>Effects</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>TITLE</code></td>
<td>Any</td>
<td>The natural-language title of your project.</td>
</tr>
<tr class="even">
<td><code>OUTPUT_FILE_NAME</code></td>
<td>Any. No spaces or punctuation.</td>
<td>Certain outputs will produce a file of this name.</td>
</tr>
<tr class="odd">
<td><code>FORMAT</code></td>
<td>pdf, pdffloat, html, htmlsimple, cssframes, htmlmulti, markdown, docx</td>
<td><em>Output format</em><br /><br /><strong>pdf</strong>: A PDF file with section numbers and a title page. Diagrams are positioned near where they are included.<br /><strong>pdffloat</strong>: A PDF file with section numbers and a title page. Diagrams are &quot;floated&quot; within the document.<br /><strong>html</strong>: A single CSS-styled HTML page with a hideable table of contents at the top.<br /><strong>htmlsimple</strong>: A single unstyled HTML page with no table of contents.<br /><strong>cssframes</strong>: A single CSS-styled HTML page with a CSS-locked navigation sidebar on the left-hand side and locked content on the right-hand side. A customizable header and footer (in header.html and footer.html) are used to frame the page.<br /><strong>htmlmulti</strong>: Multi-page CSS-styled HTML with a CSS-locked navigation bar on the left-hand side and content on the right-hand side. A customizable header and footer (in header.html and footer.html) are used to frame the page. In addition, landing.html is used as a landing page with the CSS-locked navigation sidebar on the left-hand side. Best for large projects.<br /><strong>markdown</strong>: A single markdown document.<br /><strong>docx</strong>: A single Microsoft Word document.</td>
</tr>
<tr class="even">
<td><code>HTML_STYLE</code></td>
<td>archwiki, github, custom</td>
<td>CSS styles that loosely mimic the Arch Linux Wiki and GitHub documentation. See <code>CUSTOM_CSS</code> for more information about applying custom CSS styles.</td>
</tr>
<tr class="odd">
<td><code>PDF_MAIN_FONT</code></td>
<td>Any installed font name.</td>
<td>MkTechDocs will apply this font to the main &quot;default&quot; text of output if <code>FORMAT</code> is <code>pdf</code> or <code>pdffloat</code>.</td>
</tr>
<tr class="even">
<td><code>PDF_MONO_FONT</code></td>
<td>Any installed font name.</td>
<td>MkTechDocs will apply this font to any sections of the PDF document that require a fixed-width font, such as code sections. Applies only to output if <code>FORMAT</code> is <code>pdf</code> or <code>pdffloat</code>.</td>
</tr>
<tr class="odd">
<td><code>TABLE_OF_CONTENTS_MAIN_DEPTH</code></td>
<td>1-6</td>
<td>The maximum number heading-level depth to count as a section number in the &quot;main&quot; document (not sub documents in <code>htmlmulti</code> format). For example, if <code>TABLE_OF_CONTENTS_MAIN_DEPTH</code> is 2, all level-three headings and greater will <em>not</em> appear in the table of contents.</td>
</tr>
<tr class="even">
<td><code>TABLE_OF_CONTENTS_SUB_DEPTH</code></td>
<td>1-6</td>
<td>The maximum number heading-level depth to count as a section number in sub documents for the <code>htmlmulti</code> format.</td>
</tr>
<tr class="odd">
<td><code>SECTION_NUMBERS</code></td>
<td>true,false</td>
<td>Include section numbers in headings and tables of content.</td>
</tr>
<tr class="even">
<td><code>TITLE_PAGE</code></td>
<td>Any. No spaces or puncutation.</td>
<td>See the <a href="#title-pages">title pages</a> section for more information. Applies only to <code>pdf</code> and <code>pdffloat</code> output formats.</td>
</tr>
<tr class="odd">
<td><code>IMAGES</code></td>
<td>Path to images directory -- can be absolute or relative to project directory.</td>
<td>See the <a href="#images">Images</a> section for more information. Applies to all formats.</td>
</tr>
</tbody>
</table>
<h2 id="advanced-configuration"><span class="header-section-number">5.2</span> Advanced configuration</h2>
<p>More complex documents may require finer-grain control over how documents are rendered and stylized.</p>
<table>
<colgroup>
<col width="15%" />
<col width="30%" />
<col width="53%" />
</colgroup>
<thead>
<tr class="header">
<th>Variable Name</th>
<th>Possible Values</th>
<th>Effects</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>BUILD_SCRIPT</code></td>
<td>Any</td>
<td>See the <a href="#pre--and-post-build-activities">Pre- and post-build activities</a> section for for information.</td>
</tr>
<tr class="even">
<td><code>CUSTOM_CSS</code></td>
<td>Absolute or relative path to CSS file</td>
<td>If you provide a file path here to a CSS file, MkTechDocs will copy that file into your *_pages output directory. To understand MkTechDocs CSS, see the <code>$MKTECHDOCSHOME/lib/*.css</code> files.</td>
</tr>
<tr class="odd">
<td><code>CUSTOM_TEMPLATE</code></td>
<td>Absolute or relative path to pandoc template</td>
<td>If you provide a file path here to a template file, MkTechDocs will use that template instead of one of the defaults. To understand MkTechDocs template files, see the <code>$MKTECHDOCSHOME/*_template.html</code> files. In addition, please see <code>man pandoc</code> -&gt; &quot;Variables set by pandoc&quot; for a listing of pandoc variables available to template files. For more complex use of variables, see the <a href="#python-templates">Python Templates</a> section.</td>
</tr>
<tr class="even">
<td><code>KEEP_TEMP_FILES</code></td>
<td>true,false</td>
<td>If true, mktechdocs will delete all temporary build files after completing a build.</td>
</tr>
</tbody>
</table>
<h1 id="title-pages"><span class="header-section-number">6</span> Title pages</h1>
<p>There are three ways to create a title page for your <code>pdf</code> or <code>pdffloat</code> document. In all three cases, you must create a standalone file and assign that filename to the <code>TITLE_PAGE</code> variable in your project's configuration.</p>
<h2 id="title-metadata-block"><span class="header-section-number">6.1</span> Title metadata block</h2>
<pre><code>% My Document Title
% John Doe; Jane Doe
% January 1, 2000</code></pre>
<p>For more information about this syntax: <code>man pandoc</code> and search for &quot;Metadata block.&quot;</p>
<h2 id="yaml-metadata-block"><span class="header-section-number">6.2</span> YAML metadata block</h2>
<pre><code>---
title: My Document Title
author:
  - John Doe
  - Jane Doe
date: January 1, 2001
---</code></pre>
<h2 id="templates"><span class="header-section-number">6.3</span> Templates</h2>
<p>If your title page requires dynamic content (e.g. non-static date, version number) you can create a Python template to output information as in the above two exmaples. Follow along with the example in <a href="#python-templates">Python templates</a> section.</p>
<h1 id="useful-blocks"><span class="header-section-number">7</span> Useful Blocks</h1>
<p>MkTechDocs contains built-in blocks that are useful when creating documentation.</p>
<h2 id="comment"><span class="header-section-number">7.1</span> Comment</h2>
<p>Comment blocks are ignored by MkTechDocs.</p>
<p>E.g.</p>
<pre><code>```comment
This text will be ignored.
```</code></pre>
<h2 id="include"><span class="header-section-number">7.2</span> Include</h2>
<p>The <code>include</code> block was introduced in the <a href="#master-document">basics</a> section.</p>
<table>
<colgroup>
<col width="31%" />
<col width="68%" />
</colgroup>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>heading-level</td>
<td>Provides a hint to MkTechDocs about the current heading level. In order for MkTechDocs to produce nested headings, this parameter should always be used.</td>
</tr>
</tbody>
</table>
<p>E.g.</p>
<pre><code># My header

```{.include heading-level=1}
myinclude.md
mysecondinclude.md
```</code></pre>
<p><code>include</code> blocks support infinte recursion, so included documents can contain included documents and so on.</p>
<h2 id="include-code"><span class="header-section-number">7.3</span> Include-code</h2>
<p>The <code>include-code</code> block is used to include source-code files with syntax highlighting.</p>
<table>
<colgroup>
<col width="31%" />
<col width="68%" />
</colgroup>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>language</td>
<td>Optional parameter that tells MkTechDocs what language the source code is. If no language is provided, MkTechDocs will use the file's extension. E.g. file.c -&gt; language=c</td>
</tr>
</tbody>
</table>
<p>E.g.</p>
<pre><code>```{.include-code language=c}
/home/mylogin/MkTechDocs/docs/file1.h
/home/mylogin/MkTechDocs/docs/file1.c
```</code></pre>
<p>Produces:</p>
<div class="sourceCode"><pre class="sourceCode c"><code class="sourceCode c"><span class="pp">#ifndef SOMETHING</span>
<span class="kw">typedef</span> <span class="kw">struct</span> foo {
	<span class="dt">int</span> a;
} SOMETHING;
<span class="pp">#endif</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode c"><code class="sourceCode c"><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span>
<span class="pp">#include </span><span class="im">&quot;file1.h&quot;</span>

<span class="dt">int</span> main(<span class="dt">int</span> argc, <span class="dt">char</span> **argv)
{
	printf(<span class="st">&quot;Size of SOMETHING is: %lu</span><span class="sc">\n</span><span class="st">&quot;</span>, <span class="kw">sizeof</span>(SOMETHING));
	<span class="cf">return</span> <span class="dv">0</span>;
}</code></pre></div>
<p class="note"><b>Note</b>: Paths are an issue here. Because MkTechDocs projects are built inside your project directory, for files to be included correctly a full path or a path relative to the project directory must be given. MkTechDocs does its best to copy image files and directories to the output directory, but you may need to create a post-build script for more complex operations.</p>

<h2 id="note"><span class="header-section-number">7.4</span> Note</h2>
<p><code>note</code> blocks are used to create documentation &quot;notes&quot; that appear highlighted in documentation text for HTML output formats. For PDF output, the content of the <code>note</code> block is prepended with &quot;Note:&quot;.</p>
<p>E.g.</p>
<pre><code>```note
This text will appear inside its own highlighted block and be prepended with &quot;Note:&quot;.
```</code></pre>
<p>Produces:</p>
<p class="note"><b>Note</b>: This text will appear inside its own highlighted block and be prepended with "Note:".</p>

<h2 id="plantuml"><span class="header-section-number">7.5</span> Plantuml</h2>
<p><code>plantuml</code> blocks let you include <a href="http://plantuml.com">PlantUML</a> diagramming UML directly in your documentation.</p>
<table>
<colgroup>
<col width="31%" />
<col width="68%" />
</colgroup>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>title</td>
<td>The title of the diagram. Used for a caption that appears beneath the diagram.</td>
</tr>
</tbody>
</table>
<p>E.g.</p>
<pre><code># My Diagram

```{.plantuml title=&quot;My Diagram&quot;}
A-&gt;B    
```</code></pre>
<p>Produces:</p>
<p><img src="plantuml-e7803b184aedf80b4d3cb31403a34d3e.svg" title="Fig:" alt="My Diagram" /></p>
<p class="note"><b>Note</b>: TBD: This is currently not working.</p>

<h2 id="tip"><span class="header-section-number">7.6</span> Tip</h2>
<p><code>tip</code> blocks are used to create documentation &quot;tips&quot; that appear highlighted in documentation text for HTML output formats. For PDF output, the content of the <code>tip</code> block is prepended with &quot;Tip:&quot;.</p>
<p>E.g.</p>
<pre><code>```tip
This text will appear inside its own highlighted block and be prepended with &quot;Tip:&quot;.
```</code></pre>
<p>Produces:</p>
<p class="tip"><b>Tip</b>: This text will appear inside its own highlighted block and be prepended with "Tip:".</p>

<h1 id="document-links"><span class="header-section-number">8</span> Document links</h1>
<h2 id="pandoc-links"><span class="header-section-number">8.1</span> Pandoc links</h2>
<p>Pandoc automatically creates anchor names for every heading within your documents. Therefore, generating internal links is theoretically easy thanks to Pandoc's naming convention. For example, suppose you create the following header:</p>
<pre><code># My New Header</code></pre>
<p>Here's how you'd normally create a link to it using Pandoc naming conventions:</p>
<pre><code>Some markdown text that contains a [link](#my-new-header)</code></pre>
<h2 id="mktechdocs-links"><span class="header-section-number">8.2</span> MkTechDocs links</h2>
<p>Because MkTechDocs can generate documents that require internal links that cross pages as well as documents that contain only internal relative links (as illustrated above), some thought has to be given to how links are created. When you generate internal links in your document, assume that your top-level included documents exist as HTML documents. For example, consider the following master document:</p>
<pre><code>```{.include heading-level=0}
introduction.md
middle-section.md
end.md
```</code></pre>
<p>To create links to other parts of your document, point your links to headings in <code>introduction.html</code>, <code>middle-section.html</code>, and <code>end.html</code>. For example, suppose <code>introduction.md</code> contained:</p>
<pre><code># Some heading

Some text

# Some other heading

Some more interesting text.</code></pre>
<p>To refer to a section in this file in another file:</p>
<pre><code># Middle section

Here is a [link](introduction.html#some-heading) that points to another file.</code></pre>
<p>If you follow this convention, MkTechDocs will produce correct links for every available format.</p>
<h1 id="python-templates"><span class="header-section-number">9</span> Python templates</h1>
<p>MkTechDocs contains built-in support for <a href="http://jinja.pocoo.org">Jinja2 templates</a>. Using jinja2 templates is simply a matter of creating templates (plain text files containing Jinja2 markup code) and adding a <code>.pyt</code> extension, or, in the case of your header, landing page, and footer, a <code>.htmlt</code> extension, so MkTechDocs knows how to build them.</p>
<p>To use templates in MkTechDocs, you'll need to create both a renderer and a template to render.</p>
<h2 id="the-template"><span class="header-section-number">9.1</span> The template</h2>
<p>A template is nothing more than plain text with some special Jinja2 markup thrown in. For example, let's create a dynamic title page using templates. First, we'll create a template that represents a dynamic YAML title block in our project directory:</p>
<p><strong>title-page.pyt</strong>:</p>
<pre><code>---
title: My Title {{ docVersion }}
author:
    - John Doe
    - Jane Doe
date: Built on {{ currentDateTime }}
---</code></pre>
<p>The Jinja2 templating engine will replace the variables in the double curly brackets with values you provide in the renderer.</p>
<h2 id="the-renderer"><span class="header-section-number">9.2</span> The renderer</h2>
<p>Now, in your project directory, create a renderer with the same name as the template, but replace <code>.pyt</code> with <code>.renderer</code>. MkTechDocs will automatically use the renderer associated with the template name. Renderers are built with pure Python code. Continuing with our title-page example, here is a renderer that will properly render our title page template.</p>
<p><strong>title-page.renderer</strong>:</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="co">#!/usr/bin/env python</span>

<span class="im">import</span> sys
<span class="im">import</span> datetime
<span class="im">from</span> mktechdocslib <span class="im">import</span> render_mktechdocs_jinja2_template

<span class="co">##</span>
<span class="co"># Create a simple renderer function that ouputs a template passed in on the</span>
<span class="co"># command line with the given variable dictionary.</span>
<span class="co">#</span>

<span class="kw">def</span> render():
  <span class="co"># Here, we hard code a document version, but in a real-world example, we&#39;d</span>
  <span class="co"># probably want to grab this from a configuration file or even a database.</span>
  docVersion <span class="op">=</span> <span class="st">&quot;0.1a&quot;</span>

  <span class="co"># Now set up the date and time however you see fit</span>
  currentDateTime <span class="op">=</span> datetime.datetime.now().strftime(<span class="st">&quot;%I:%M%p on %B </span><span class="sc">%d</span><span class="st">, %Y&quot;</span>)

  varDictionary <span class="op">=</span> {<span class="st">&quot;docVersion&quot;</span>:docVersion, <span class="st">&quot;currentDateTime&quot;</span>:currentDateTime}

  <span class="cf">if</span> <span class="kw">not</span> os.path.isfile(sys.argv[<span class="dv">1</span>]):
    sys.stderr.write(<span class="st">&quot;Cannot find &quot;</span> <span class="op">+</span> sys.argv[<span class="dv">1</span>] <span class="op">+</span> <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)
    sys.exit(<span class="dv">1</span>)

  <span class="bu">print</span> render_mktechdocs_jinja2_template(sys.argv[<span class="dv">1</span>], varDictionary)

<span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&quot;__main__&quot;</span>:
  render()</code></pre></div>
<p>You can add as many variables to your <code>varDictionary</code> as necessary. You can even add entire modules and functions, if you need more logic in your templates.</p>
<p>Next, set the <code>TITLE_PAGE</code> variable in your project makefile to <code>title-page.md</code>. Why the <code>.md</code> extension? MkTeckDocs automatically converts anything with a <code>.pyt</code> extension to markdown before building your documents. Here's a diagram that illustrates the process:</p>
<p><img src="plantuml-2697328e27cbb82edab5163837c46ceb.svg" title="Fig:" alt="Template Rendering" /></p>
<p>Since title pages are only used in PDF documents (currently), you should also set <code>FORMAT</code> to <code>pdf</code> or <code>pdffloat</code>.</p>
<h2 id="referencing-templates-in-include-blocks"><span class="header-section-number">9.3</span> Referencing templates in include blocks</h2>
<p>MkTechDocs automatically detects <code>*.pyt</code> templates and converts them into markdown before processing include blocks. So, if you need to include the contents of a template's output in another markdown file, simply treat the template as if it were markown. For example, if your template's name is <code>mytemplate.pyt</code> reference the output in include blocks like:</p>
<pre><code>```include
mytemplate.md
```</code></pre>
<h2 id="footer.html-header.html-and-landing.html-as-templates"><span class="header-section-number">9.4</span> <code>footer.html</code>, <code>header.html</code>, and <code>landing.html</code> as templates</h2>
<p>MkTechDocs will recognize <code>footer.htmlt</code>, <code>header.htmlt</code>, and <code>landing.htmlt</code> as templates and process into corresponding <code>.html</code> files, using similarly named renderers. E.g. <code>footer.renderer</code>.</p>
<h2 id="escaping-curly-brackets"><span class="header-section-number">9.5</span> Escaping curly brackets</h2>
<p>Because every MkTechDocs document is ultimately converted into a large Python Jinja2 template, if you want to include double curly brackets as curly brackets in your document, for example, if you're documenting Jinja2, you will need to escape them.</p>
<p>Here's how:</p>
<pre><code>    {% raw %}
 
    {{somevar}}
 
    {% endraw %}</code></pre>
<p>If you need to escape a single curly bracket, you can use:</p>
<p>
<code>{{openCurlyBracket}}</code> and <code>{{closeCurlyBracket}}</code>
</p>
<h2 id="for-more-information"><span class="header-section-number">9.6</span> For more information</h2>
<p>For real-world examples of how to use Jinja2 templates with MkTechDocs, see the following files in the MkTechDocs directory:</p>
<pre><code>docsbuild/runningfilters.pyt
docsbuild/runningfilters.renderer
docsbuild/scripts.pyt
docsbuild/scripts.renderer</code></pre>
<p>These templates and renderers incorporate some pythondoc-like markup in the <a href="#running-filters">filters</a> and <a href="#scripts">scripts</a> that come with MkTechDocs.</p>
<p>Jinja2 templates can be powerful documentation tools. Please reference the <a href="http://jinja.pocoo.org/docs/2.9/templates/">Jinja2 template documentation</a> for more information 2&gt;$template.err.</p>
<h1 id="managing-document-versions"><span class="header-section-number">10</span> Managing document versions</h1>
<p>For some documentation projects, managing document versions is vital. It is helpful if you define your document version in one place, so that any sub-documents that reference the version number get it from the same place.</p>
<p>The following is one reasonable way of doing this.</p>
<h2 id="global_vars"><span class="header-section-number">10.1</span> <code>global_vars</code></h2>
<p>Whether you're using Python or Groovy, it's probably a good idea to create a module (file) called <code>global_vars.py</code> to hold any static variables or functions you need to build your project, such as a version string. Here are the steps:</p>
<ol style="list-style-type: decimal">
<li>Add your project's directory to <code>PYTHONPATH</code>.</li>
<li>For any documents that need access to information stored in global_vars, you simply convert the document into a template (by renaming it from <code>.md</code> to <code>.pyt</code>, for example).</li>
<li><code>import global_vars</code> as a module in your renderer and include it in your variable dictionary.</li>
<li>Now, you can access global variables and functions in glob.py in your templates that have imported it: e.g. <code>version=global_vars.VERS</code>.</li>
</ol>
<h1 id="incorporating-groovy-code-and-templates"><span class="header-section-number">11</span> Incorporating Groovy code and templates</h1>
<p>Groovy integration is an optional step and only necessary if you want to access existing Java libraries.</p>
<h2 id="installation-of-groovy-components"><span class="header-section-number">11.1</span> Installation of groovy components</h2>
<p>First, start by examining and then running whichever <code>install_deps_*_groovy.sh</code> script in <code>$MKTECHDOCSHOME/bin/groovy</code> is appropriate for your architecture.</p>
<p>They install two packages, groovy and gradle. Then, they download a Groovy library called <code>groovy-pandoc</code> from GitHub and install the resulting jar file in <code>$MKTECHDOCSHOME/lib</code>.</p>
<h3 id="environment"><span class="header-section-number">11.1.1</span> Environment</h3>
<p>Next, add <code>$MKTECHDOCSHOME/bin/groovy</code> to your <code>PATH</code> environment variable. Here's an example in Bash:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="bu">export</span> <span class="va">PATH=$PATH</span>:<span class="va">$MKTECHDOCSHOME</span>/bin/groovy</code></pre></div>
<h3 id="testing-the-integration"><span class="header-section-number">11.1.2</span> Testing the integration</h3>
<p>Finally, run <code>$MKTECHDOCSHOME/test/testgroovyintegration.sh</code>. Your output should look something like this:</p>
<pre><code>[~/MkTechDocs/test]$ testgroovyintegration.sh
Generating &#39;svg&#39; plantuml diagram named &#39;Diagram&#39;
Test dependency installation
============================

First, we&#39;ll try an include:

Include test file
-----------------

This text is coming from inside test\_install\_include.md.

Now, we&#39;ll try some plantUML:

![Diagram](./8410b9ad92ce7f3e2d564faff2b834b1.plantuml.svg){#myid}
Pandoc seems ok.


Checking groovy...

If this prints with no error, you are good to go
Groovy seems ok.
[~/MkTechDocs/test]$</code></pre>
<h2 id="groovy-templates"><span class="header-section-number">11.2</span> Groovy templates</h2>
<p>You can use Groovy templates (<code>*.gt</code>) as you would Jinja2 Python templates, except that Groovy templates do not require a renderer, which makes them somewhat more convenient. However, this comes at a price. Groovy templates are far slower than Jinja2 to generate, even with <a href="https://kobo.github.io/groovyserv/">GroovyServ</a> installed.</p>
<p>Groovy templates work like PHP or JSP files. You can include plain text markdown and Groovy clode blocks. Here's an example:</p>
<pre class="groovy"><code># An example Groovy template

Let&#39;s count to 10:

&lt;%
(1..10).each { n -&gt;
    out.println(n)
}
%&gt;</code></pre>
<p>Here's the output:</p>
<pre><code>$ gtp testtemplate.gt
# An example Groovy template

Let&#39;s count to 10:

1
2
3
4
5
6
7
8
9
10


$</code></pre>
<p>Notice that <code>gtp</code> is a standalone template renderer that MkTechDocs uses to render <code>*.gt</code> files.</p>
<h2 id="groovy-classes"><span class="header-section-number">11.3</span> Groovy classes</h2>
<p>You might need standalone classes for your Groovy templates. To do this, create *.groovy files in your documentation directory. MkTechDocs will automatically detect and compile these into *.class files.</p>
<p>For example, MkTechDocs includes a class called <code>MarkdownUtils</code>, a utility class. Even though you wouldn't likely use it in a real project, the following demonstrates the concept.</p>
<p>test.md:</p>
<pre><code># This is a level-one header

## This is a level-two header</code></pre>
<p>mytempl.gt:</p>
<pre class="groovy"><code># Some heading

&lt;%
import MarkdownUtils

def f = new File(&quot;./test.md&quot;)

out &lt;&lt; MarkdownUtils.getMarkdownFileAndChangeHeader(f, 2)
%&gt;</code></pre>
<p>And here is the output:</p>
<pre><code>[~/MkTechDocs/docs]$ gtp mytempl.gt
# Some heading

### This is a level-one header

#### This is a level-two header


[~/MkTechDocs/docs]$</code></pre>
<p>Note how the heading levels were increased by two levels, which is exactly what the <code>getMarkdownFileAndChangeHeader</code> function does.</p>
<h2 id="classpath"><span class="header-section-number">11.4</span> <code>CLASSPATH</code></h2>
<p>MkTechDocs creates a <code>CLASSPATH</code> automatically in order to process templates. However, if you need to add jars or directories to your CLASSPATH outside of MkTechDocs, simply create an environment variable. Here is an example in Bash:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="bu">export</span> <span class="va">CLASSPATH=</span>/path/to/my.jar</code></pre></div>
<p>Now, when MkTechDocs runs, it will build a <code>CLASSPATH</code> that includes any existing <code>CLASSPATH</code>.</p>
<h1 id="team-documentation"><span class="header-section-number">12</span> Team documentation</h1>
<p>MkTechDocs is ideal for incorporating team-contributed documentation. Because MkTechDocs documentation is simple Markdown, team members can contribute or edit documents via Git (for example) and let a single technical writer manage the pull requests to keep things as simple and as clear as possible.</p>
<p>This makes scaling documentation easier because the technical writer is no longer limited to his or her own domain knowledge or learned knowledge.</p>
<p>That's a simple case. The following describes a different scenario that lets agile developers contribute to documentation in a more specific and controlled way.</p>
<h2 id="case-study"><span class="header-section-number">12.1</span> Case study</h2>
<p>In this study, a number of different agile development teams are responsible for individual components of a larger system. A configuration repository maintained by the larger system consists of a number of YAML files that describe the general deployment of each component.</p>
<p>Here, components could be Docker containers, VMs, micro-services, or whatever. Each component could have a different but similar set of deployment instructions for each category below, or it could simply conform to some generic set of instructions and require no extra documentation.</p>
<ol style="list-style-type: decimal">
<li>Overview</li>
<li>Environmental-setup</li>
<li>Pre-deployment</li>
<li>Deployment</li>
<li>Undeployment</li>
<li>Upgrading</li>
<li>Jenkins integration</li>
</ol>
<p>Agile team members in this scenario are encouraged to contribute documentation in support of their respective components with those steps in mind. If they feel that specialized instructions for any of the above areas applies to their component, they should create a file in a provided directory within the documention tree that matches their component name in the configuration YAML. This file should contain a standalone Markdown document containing instructions specific for their component for that particular step. E.g. <code>overview/mycomponent.md</code>, <code>upgrading/mycomponent.md</code>.</p>
<p>For example, suppose a VM named <code>vm-inventory</code> exists in some YAML configuration file:</p>
<div class="sourceCode"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span class="fu">location:</span>
  <span class="fu">description:</span><span class="at"> &gt;</span>
    This is a sample description of a particular location
  <span class="fu">vm-deployments:</span>
         .
         .
         .
    <span class="fu">vm-inventory:</span>
      <span class="fu">vm-config:</span><span class="at"> vmi.cfg</span>
      <span class="fu">release:</span><span class="at"> 1.234</span>
      <span class="fu">notes:</span><span class="at"> Some notes about this particular VM</span>
        .
        .
        .</code></pre></div>
<p>Now, we can create a template that loads the YAML containing the list of components, and looks for files with the same name in the directories listed above. If we find specialized instructions, we output them for a particular stage (e.g. Overview, Undeployment). If we find no specialized instructions, we output some generic ones.</p>
<h2 id="managing-git-commit-messages"><span class="header-section-number">12.2</span> Managing git commit messages</h2>
<p>Often, it is useful for your document's audience to understand what has changed from version to version. Rather than keeping track of this manually, in a &quot;change log,&quot; for example, you can leverage Git's commit system.</p>
<p>The <code>git log</code> command shows a list of all commits to a respository. Each commit has a unique ID associated with it (SHA1 collisions not withstanding). This means that you can create &quot;versions&quot; by recording specific commit messages that represent the beginning and ending of a document version, pulling out all relevant commit messages dynamically when the document is built.</p>
<p>MkTechDocs includes this functionality in the <code>mktechdocslib.py</code> module. Here's an example of how to use it.</p>
<h3 id="gitcommitdb"><span class="header-section-number">12.2.1</span> GitCommitDB</h3>
<p>What we'd like to do is create a simple database of Git messages that exist between two arbitrary Git commit IDs. First, we examine the output of <code>git log</code> to determine the first and last commit IDs that frame the version of the document we're interested in creating. Note that the output of <code>git log</code> is ordered by commit date, so the most recent dates appear first.</p>
<p>Here is a sample Git log:</p>
<pre><code>commit 20de5c8bf2a53efe54a71ae06e5b0b2a813d5176
Author: Seidel, Joseph (js2589) &lt;spence@research.att.com&gt;
Date:   Tue Mar 7 08:04:25 2017 -0500

    Fixed several formatting issues

commit 3523b7f36d928519bba9568852babd793e783a7c
Merge: cd6c4bc f9b3edf
Author: Seidel, Joseph (js2589) &lt;spence@research.att.com&gt;
Date:   Tue Mar 7 06:50:53 2017 -0600

    Merge pull request #71 in FOO_BAR/foo.bar.documentation from feature/FOOBAR/FOOBAR to master

    * commit &#39;f9b3edfb5194a2be0456d26d742043677948d5ea&#39;:
      Added some notes about documentation formats

commit f9b3edfb5194a2be0456d26d742043677948d5ea
Author: Seidel, Joseph (js2589) &lt;spence@research.att.com&gt;
Date:   Mon Mar 6 16:21:17 2017 -0500

    Added some notes about documentation formats</code></pre>
<p>From this, we determine that the first commit ID is <code>f9b3edfb5194a2be0456d26d742043677948d5ea</code> and the last commit ID is <code>20de5c8bf2a53efe54a71ae06e5b0b2a813d5176</code>.</p>
<p>Now, in a template.renderer, we can do something like this:</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="co">#!/usr/bin/env python</span>

<span class="im">import</span> os
<span class="im">import</span> sys
<span class="im">import</span> datetime
<span class="im">import</span> global_vars
<span class="im">from</span> mktechdocslib <span class="im">import</span> GitCommitDB, render_mktechdocs_jinja2_template

<span class="co">##</span>
<span class="co"># Create a simple renderer function that ouputs a template passed in on the</span>
<span class="co"># command line with the given variable dictionary.</span>
<span class="co">#</span>

<span class="kw">def</span> render():
    messages <span class="op">=</span> GitCommitDB(<span class="st">&quot;f9b3edfb5194a2be0456d26d742043677948d5ea&quot;</span>, <span class="st">&quot;20de5c8bf2a53efe54a71ae06e5b0b2a813d5176&quot;</span>).messages
    varDictionary <span class="op">=</span> {<span class="st">&quot;gitMessages&quot;</span>:messages,
                     <span class="st">&quot;numCommits&quot;</span>:<span class="bu">len</span>(messages)}
    
    <span class="cf">if</span> <span class="kw">not</span> os.path.isfile(sys.argv[<span class="dv">1</span>]):
        sys.stderr.write(<span class="st">&quot;Cannot find &quot;</span> <span class="op">+</span> sys.argv[<span class="dv">1</span>] <span class="op">+</span> <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)
        sys.exit(<span class="dv">1</span>)

    <span class="bu">print</span> render_mktechdocs_jinja2_template(sys.argv[<span class="dv">1</span>], varDictionary)

<span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&quot;__main__&quot;</span>:
    render()</code></pre></div>
<p>Here, we import <code>GitCommitDB</code> from <code>mktechdocslib</code> and add the <code>GitCommitDB.messages</code> list object to our variable dictionary. <code>messages</code> contains a list of <code>GitCommitMessage</code> objects, which have the following properties:</p>
<table>
<thead>
<tr class="header">
<th>Property</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>id</td>
<td>String</td>
<td>Commit ID</td>
</tr>
<tr class="even">
<td>mergeID</td>
<td>String</td>
<td>Merge commit ID</td>
</tr>
<tr class="odd">
<td>author</td>
<td>String</td>
<td>Author of the commit</td>
</tr>
<tr class="even">
<td>date</td>
<td>String</td>
<td>Commit date</td>
</tr>
<tr class="odd">
<td>message</td>
<td>String</td>
<td>Commit message</td>
</tr>
<tr class="even">
<td>mergeCommit</td>
<td>boolean</td>
<td>True if the commit is a merge</td>
</tr>
</tbody>
</table>
<p>Finally, here's our template that displays the information we're interested in:</p>
<pre><code># Document change log

{% if numCommits == 0 %}
Looks like no changes have been committed.
{% endif %}

{% for m in gitMessages %}

{% if not m.mergeCommit %}
**Date**: {{ m.date }}&lt;br /&gt;
**Author**: {{ m.author }}&lt;br /&gt;
**Message**: {{ m.message }}&lt;br /&gt;
{% endif %}

{% endfor %}</code></pre>
<p>The version in the example above was hard coded. In reality, it would be better to keep track of version information in a list of tuples. For example:</p>
<p><strong>versions.py</strong>:</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">gVersions <span class="op">=</span> [(<span class="st">&quot;1.0&quot;</span>, <span class="st">&quot;2017-04-06&quot;</span>, <span class="st">&quot;f9b3edfb5194a2be0456d26d742043677948d5ea&quot;</span>, <span class="st">&quot;20de5c8bf2a53efe54a71ae06e5b0b2a813d5176&quot;</span>),
             (<span class="st">&quot;0.9&quot;</span>, <span class="st">&quot;2017-03-25&quot;</span>, <span class="st">&quot;d453519c024a49806fbd3a6740a9f0f586aaafbc&quot;</span>, <span class="st">&quot;57831131f186a60b864af27e53e06d2772a6d1ef&quot;</span>)]</code></pre></div>
<p>In this scheme, the latest version tuple would always be <code>gVersions[0]</code>. Or, if you prefer to store the versions in reverse order: <code>gVersions[len(gVersions)-1]</code>. Then, our renderer would look like this:</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="co">#!/usr/bin/env python</span>

<span class="im">import</span> os
<span class="im">import</span> sys
<span class="im">import</span> datetime
<span class="im">import</span> global_vars
<span class="im">from</span> versions <span class="im">import</span> gVersions
<span class="im">from</span> mktechdocslib <span class="im">import</span> GitCommitDB, render_mktechdocs_jinja2_template

<span class="co">##</span>
<span class="co"># Create a simple renderer function that ouputs a template passed in on the</span>
<span class="co"># command line with the given variable dictionary.</span>
<span class="co">#</span>

<span class="kw">def</span> render():
    (versString, date, fcid, lcid) <span class="op">=</span> gVersions[<span class="dv">0</span>]
    
    messages <span class="op">=</span> GitCommitDB(fcid, lcid).messages
    
    varDictionary <span class="op">=</span> {<span class="st">&quot;gitMessages&quot;</span>:messages,
                     <span class="st">&quot;numCommits&quot;</span>:<span class="bu">len</span>(messages),
                     <span class="st">&quot;versString&quot;</span>:versString,
                     <span class="st">&quot;date&quot;</span>:date}
    
    <span class="cf">if</span> <span class="kw">not</span> os.path.isfile(sys.argv[<span class="dv">1</span>]):
        sys.stderr.write(<span class="st">&quot;Cannot find &quot;</span> <span class="op">+</span> sys.argv[<span class="dv">1</span>] <span class="op">+</span> <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)
        sys.exit(<span class="dv">1</span>)

    <span class="bu">print</span> render_mktechdocs_jinja2_template(sys.argv[<span class="dv">1</span>], varDictionary)

<span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&quot;__main__&quot;</span>:
    render()</code></pre></div>
<h1 id="download"><span class="header-section-number">13</span> Download</h1>
<p>To download MkTechDocs, clone the repo:</p>
<p><code>git clone https://github.com/att/MkTechDocs</code></p>
<h1 id="setting-up-your-environment"><span class="header-section-number">14</span> Setting up your environment</h1>
<p>Please export the following variables. Here is an example in Bash:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="co"># MkTechDocs libraries and scripts require the following variable:</span>
<span class="bu">export</span> <span class="va">MKTECHDOCSHOME=</span>/path/to/cloned/repo/MkTechDocs

<span class="co"># Make sure the MkTechDocs bin directory is in your path:</span>
<span class="bu">export</span> <span class="va">PATH=$PATH</span>:<span class="va">$MKTECHDOCSHOME</span>/bin

<span class="co"># Let Python know where to find MkTechDocs libraries:</span>
<span class="bu">export</span> <span class="va">PYTHONPATH=$MKTECHDOCSHOME</span>/bin</code></pre></div>
<h2 id="running-the-dependencies-installation-script"><span class="header-section-number">14.1</span> Running the dependencies installation script</h2>
<p>Install MkTechDocs dependencies using the (admittedly imperfect) installation script. Consider the script more of a guide.</p>
<p>Examine the contents of the <code>$MKTECHDOCSHOME/bin/install_deps*sh</code> script appropriate for your architecture (Ubuntu, Arch, Fedora, and macOS are currently supported). For Groovy support, please also see the <code>install_deps*sh</code> scripts in the <code>bin/groovy</code> directory. The install script simply tries to install the various dependencies using an architecture-appropriate package manager and in some cases checks version numbers of installed binaries. You can also install the dependencies manually.</p>
<h3 id="dependencies"><span class="header-section-number">14.1.1</span> Dependencies</h3>
<p>MkTechDocs requires the following:</p>
<table>
<thead>
<tr class="header">
<th align="left">Package</th>
<th align="left">Version</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Bash</td>
<td align="left">any recent</td>
<td align="left">A shell.</td>
</tr>
<tr class="even">
<td align="left">Git</td>
<td align="left">any recent</td>
<td align="left">A distributed version-control system.</td>
</tr>
<tr class="odd">
<td align="left">Pandoc</td>
<td align="left">&gt;= 1.18</td>
<td align="left">Pandoc is a powerful document conversion tool and is at the heart of MkTechDocs.</td>
</tr>
<tr class="even">
<td align="left">Make</td>
<td align="left">any recent</td>
<td align="left">A tool to help manage document dependencies during the build process.</td>
</tr>
<tr class="odd">
<td align="left">Graphviz</td>
<td align="left">any recent</td>
<td align="left">A collection of open-source tools for drawing graphs in the DOT language.</td>
</tr>
<tr class="even">
<td align="left">Plantuml</td>
<td align="left">any recent</td>
<td align="left">A tool for creating UML diagrams that uses Graphviz underneath.</td>
</tr>
<tr class="odd">
<td align="left">XeTeX</td>
<td align="left">any recent</td>
<td align="left">A suite of tools for building PDF documents.</td>
</tr>
<tr class="even">
<td align="left">Python</td>
<td align="left">2.7</td>
<td align="left">MkTechDocs is currently compatible with Python 2.7.</td>
</tr>
<tr class="odd">
<td align="left">Jinja2</td>
<td align="left">2+</td>
<td align="left">A Python templating library.</td>
</tr>
<tr class="even">
<td align="left">homebrew**</td>
<td align="left">any recent</td>
<td align="left">A package manager for macOS.</td>
</tr>
</tbody>
</table>
<p>** <em>homebew</em>: macOS only</p>
<p><strong>Groovy/Java</strong>*</p>
<table>
<thead>
<tr class="header">
<th align="left">Package</th>
<th align="left">Version</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Java*</td>
<td align="left">&gt;= 1.8</td>
<td align="left">MkTechDocs is currently compatible with Java 1.8</td>
</tr>
<tr class="even">
<td align="left">Groovy*</td>
<td align="left">&gt; 2.0</td>
<td align="left">A Java-like scripting language that extends Java.</td>
</tr>
<tr class="odd">
<td align="left">groovy-pandoc*</td>
<td align="left">&gt;= 0.8</td>
<td align="left">A Groovy library used to build Pandoc filters for document transformation.</td>
</tr>
<tr class="even">
<td align="left">Gradle*</td>
<td align="left">&gt; 3.0</td>
<td align="left">A build automation system that is friendly to the Groovy language.</td>
</tr>
</tbody>
</table>
<p>*: Java/Groovy dependencies are optional but ideal for interfacing
MkTechDocs with existing Java libraries. Note that Groovy pandoc filters
are orders of magnitude slower than their Python counterparts. To
shorten build time, you might want to try
<a href="https://kobo.github.io/groovyserv/userguide.html">GroovyServ</a>.</p>
<h2 id="testing-your-environment"><span class="header-section-number">14.2</span> Testing your environment</h2>
<p>After installing the dependencies, run this:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="bu">cd</span> <span class="va">$MKTECHDOCSHOME</span>/test
<span class="ex">./testinstall.sh</span></code></pre></div>
<p>You should see something like this:</p>
<pre><code>[~/MkTechDocs/test]$ ./testinstall.sh
Created image plantuml-c6117aebb4ce8e59ba2b46950eca869f.svg
Test dependency installation
============================

First, we&#39;ll try an include:

Include test file
-----------------

This text is coming from inside test\_install\_include.md.

Now, we&#39;ll try some plantUML:

![](plantuml-c6117aebb4ce8e59ba2b46950eca869f.svg)
Pandoc seems ok.


Checking python...

If this prints with no error, you are good to go!
Python seems ok.
[~/MkTechDocs/test]$</code></pre>
<p>If you get errors, examine the output of the installation script to see where something went wrong.</p>
<h2 id="a-note-about-titlesec"><span class="header-section-number">14.3</span> A note about titlesec</h2>
<p>MkTechDocs uses a TeX package named <code>titlesec</code> to do various things with PDF section numbers (e.g. 6.1.3.2). Unfortunately, Ubuntu 16.04 LTS ships with a buggy version of this package, which causes section numbers to be empty in various situations, so replacing it will be necessary if you plan to use section numbering in PDF documents. To replace it, first download the latest titlesec from <code>https://www.ctan.org/tex-archive/macros/latex/contrib/titlesec</code>.</p>
<p>Now:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">unzip</span> titlesec.zip
<span class="fu">sudo</span> rm -rf /usr/share/texlive/texmf-dist/tex/latex/titlesec
<span class="fu">sudo</span> mkdir /usr/share/texlive/texmf-dist/tex/latex/titlesec
<span class="fu">sudo</span> cp -r titlesec/* /usr/share/texlive/texmf-dist/tex/latex/titlesec/.</code></pre></div>
<p>Section numbering should work as expected.</p>
<h1 id="running-filters"><span class="header-section-number">15</span> Running filters</h1>
<p>Running MkTechDocs Pandoc filters outside of the normal build environment is easy if you've <a href="#setting-up-your-environment">set up your environment</a> properly:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="ex">pandoc</span> --filter <span class="op">&lt;</span>flt-filtername.py<span class="op">&gt;</span> -f markdown -t some-other-format inputfile.md <span class="op">&gt;</span>outputfile.fmt</code></pre></div>
<p>In some cases, MkTechDocs filters produce artifacts on STDERR. In these cases use something like the following:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="ex">pandoc</span> --filter <span class="op">&lt;</span>flt-filtername.py<span class="op">&gt;</span> -f markdown -t some-other-format inputfile.md <span class="op">&gt;</span>outputfile.fmt <span class="op">2&gt;</span>artifacts.out</code></pre></div>
<p>The following Pandoc python filters come with MkTechDocs. Groovy versions are available as well in <code>$MKTECHDOCSHOME/bin/groovy</code>. They are run in the same way (but have a .groovy extension).</p>
<h2 id="flt-comment-block.py"><span class="header-section-number">15.1</span> <code>flt-comment-block.py</code></h2>
<p>Adapted from https://github.com/jgm/pandocfilters/blob/master/examples/comments.py</p>
<p>Pandoc filter that causes everything between
'&lt;!-- BEGIN COMMENT --&gt;' and '&lt;!-- END COMMENT --&gt;'
to be ignored. The comment lines must appear on
lines by themselves, with blank lines surrounding
them.</p>
<p>E.g.</p>
<pre><code> &lt;!-- BEGIN COMMENT --&gt;
 
 This text will be ignored.
 
 &lt;!-- END COMMENT --&gt;</code></pre>
<h2 id="flt-comment.py"><span class="header-section-number">15.2</span> <code>flt-comment.py</code></h2>
<p>Ignores all text contained in the comment block. E.g.</p>
<pre><code> ```comment
 This text will be ignored.
 ````</code></pre>
<h2 id="flt-decrement-header-1.py"><span class="header-section-number">15.3</span> <code>flt-decrement-header-1.py</code></h2>
<p>Decrements all headers by 1 level</p>
<h2 id="flt-decrement-header-2.py"><span class="header-section-number">15.4</span> <code>flt-decrement-header-2.py</code></h2>
<p>Decrements all headers by 2 levels</p>
<h2 id="flt-decrement-header-3.py"><span class="header-section-number">15.5</span> <code>flt-decrement-header-3.py</code></h2>
<p>Decrements all headers by 3 levels</p>
<h2 id="flt-decrement-header-4.py"><span class="header-section-number">15.6</span> <code>flt-decrement-header-4.py</code></h2>
<p>Decrements all headers by 4 levels</p>
<h2 id="flt-decrement-header-5.py"><span class="header-section-number">15.7</span> <code>flt-decrement-header-5.py</code></h2>
<p>Decrements all headers by 5 levels</p>
<h2 id="flt-get-includes.py"><span class="header-section-number">15.8</span> <code>flt-get-includes.py</code></h2>
<p>Outputs all files referenced in any include blocks in
a file to stderr. Used internally by MkTechDocs to
build dependency lists.</p>
<h2 id="flt-include-code.py"><span class="header-section-number">15.9</span> <code>flt-include-code.py</code></h2>
<p>This filter allows you to include source-code files in
your markdown.</p>
<p>You can provide one file per line. If you include the
&quot;language&quot; property:</p>
<pre><code> ```{.include-code language=&quot;java&quot;}
 myfile.java
 myfile.sh
 ```</code></pre>
<p>The filter will use whatever language you specify in
the property regardless of what the file extensions are,
which you may or may not want.</p>
<p>If you provide something like the following:</p>
<pre><code> ```include-code
 myfile.java
 myfile.bash
 myfile.c
 ```</code></pre>
<p>The filter will produce 3 code blocks with the
language property automatically set based on the extension
of the files within.</p>
<h2 id="flt-include-doc-map.py"><span class="header-section-number">15.10</span> <code>flt-include-doc-map.py</code></h2>
<p>This filter is identical to the include filter, except
that while building a document, it outputs a document
map on stderr so that a script can figure out where each part of
the document came from. E.g.</p>
<pre><code>     ```include
     includethisfile.md
     ```</code></pre>
<p>This filter is recursive, so you markdown can include
other markdown to any level.</p>
<h2 id="flt-include.py"><span class="header-section-number">15.11</span> <code>flt-include.py</code></h2>
<p>This filter allows you to include other markdown in
your markdown. E.g.</p>
<pre><code>     ```include
     includethisfile.md
     ```</code></pre>
<p>This filter is recursive, so your markdown can include
other markdown to any level.</p>
<p>Header levels are automatically adjusted to the correct
heading level if you use the &quot;heading-level&quot; attribute:</p>
<pre><code> # Heading One

 Some text

 ## Heading Two

 ```{.include heading-level=2}
 somefiletoinclude.md
 ````</code></pre>
<p>&quot;heading-level&quot; represents the heading level where the
include happens. On subsequent inclusion, the heading levels
in the included file will be increased by two. Of course, you
can always leave out the heading-level if you don't want
to alter the heading level of the included file.</p>
<p>Even multiple levels of include recursion will result in
headers of the correct level. The reason this works is by
virtue of the dependency lists generated by the makefile.</p>
<p>The lowest level pages (i.e. the last file included in a
recursive string of includes), are processed and stored
to disk first.</p>
<p>When the next outer level is processed, those headers are
adjusted and the previously adjusted levels in the included file
are in effect adjusted again. Then, the next level is adjusted,
and so are all the inclusions.</p>
<p>This results in the innermost include's headers being
adjusted upwards by however many levels of recursion
there are.</p>
<h2 id="flt-increment-header-1.py"><span class="header-section-number">15.12</span> <code>flt-increment-header-1.py</code></h2>
<p>Increments all headers by 1 level to a maximum of 6 levels.</p>
<h2 id="flt-increment-header-2.py"><span class="header-section-number">15.13</span> <code>flt-increment-header-2.py</code></h2>
<p>Increments all headers by 2 levels to a maximum of 6 levels.</p>
<h2 id="flt-increment-header-3.py"><span class="header-section-number">15.14</span> <code>flt-increment-header-3.py</code></h2>
<p>Increments all headers by 3 levels to a maximum of 6 levels.</p>
<h2 id="flt-increment-header-4.py"><span class="header-section-number">15.15</span> <code>flt-increment-header-4.py</code></h2>
<p>Increments all headers by 4 levels to a maximum of 6 levels.</p>
<h2 id="flt-increment-header-5.py"><span class="header-section-number">15.16</span> <code>flt-increment-header-5.py</code></h2>
<p>Increments all headers by 5 levels to a maximum of 6 levels.</p>
<h2 id="flt-notetip.py"><span class="header-section-number">15.17</span> <code>flt-notetip.py</code></h2>
<p>This filter replaces 'note' and 'tip' blocks with
div tags of either a note or tip class</p>
<p>E.g.</p>
<pre><code> ```tip
 My tip
 ```</code></pre>
<p>Becomes:</p>
<pre><code> &lt;div class=&#39;tip&#39;&gt;**Tip**: My tip&lt;/div&gt;</code></pre>
<p>for markdown and html. For other output formats:</p>
<p>TIP: My tip</p>
<h2 id="flt-plantuml.py"><span class="header-section-number">15.18</span> <code>flt-plantuml.py</code></h2>
<p>Adapted from: <a href="https://github.com/jgm/pandocfilters/blob/master/examples/plantuml.py" class="uri">https://github.com/jgm/pandocfilters/blob/master/examples/plantuml.py</a></p>
<p>Turns PlantUML, e.g.:</p>
<pre><code> ```plantuml
 actor Foo1
 boundary Foo2
 control Foo3
 entity Foo4
 database Foo5
 Foo1 -&gt; Foo2 : To boundary
 Foo1 -&gt; Foo3 : To control
 Foo1 -&gt; Foo4 : To entity
 Foo1 -&gt; Foo5 : To database
 ````</code></pre>
<p>Into an image for inclusion in HTML documents.</p>
<p>To affect the output format, provide a metadata variable on the command line:</p>
<pre><code> pandoc -M umlformat=[eps,svg] . . .</code></pre>
<p>If no umlformat is indicated, the filter will default to svg.</p>
<p>Needs <code>plantuml.jar</code> from http://plantuml.com/.</p>
<h2 id="flt-strip-pages-from-links.py"><span class="header-section-number">15.19</span> <code>flt-strip-pages-from-links.py</code></h2>
<p>This filter turns links like this:</p>
<pre><code> [foo link](somepage.html#some-heading)</code></pre>
<p>into:</p>
<pre><code> [foo link](#some-heading)</code></pre>
<p>This is necessary to transform documents from multi-page
to single page.</p>
<h2 id="flt-template.py"><span class="header-section-number">15.20</span> <code>flt-template.py</code></h2>
<p>A starting point for building new filters.</p>
<h1 id="scripts"><span class="header-section-number">16</span> Scripts</h1>
<p>Several potentially useful scripts come with MkTechDocs.</p>
<h2 id="check_build_env.sh"><span class="header-section-number">16.1</span> <code>check_build_env.sh</code></h2>
<p>This script does a simplistic check on your build environment
to make sure that a MkTechDocs project can build.</p>
<table style="width:99%;">
<colgroup>
<col width="30%" />
<col width="68%" />
</colgroup>
<tbody>
<tr class="odd">
<td align="left">Example usage</td>
<td align="left"><code>check_build_env.sh</code></td>
</tr>
<tr class="even">
<td align="left">Arguments</td>
<td align="left">None</td>
</tr>
<tr class="odd">
<td align="left">Special exit values</td>
<td align="left">1 Problem with build environment<br />
0 No problems with build environment</td>
</tr>
</tbody>
</table>
<h2 id="dec-headers.sh"><span class="header-section-number">16.2</span> <code>dec-headers.sh</code></h2>
<p>A utility script that decrements the headers in a given
markdown file by a given number of levels.</p>
<p>A copy of the original file is kept using the origial
file name and a PID as the extension.</p>
<table style="width:99%;">
<colgroup>
<col width="30%" />
<col width="68%" />
</colgroup>
<tbody>
<tr class="odd">
<td align="left">Example usage</td>
<td align="left"><code>dec-headers.sh file.md 1</code></td>
</tr>
<tr class="even">
<td align="left">Arguments</td>
<td align="left">1 A file to alter.<br />
2 The number of heading levels to decrement.</td>
</tr>
<tr class="odd">
<td align="left">Special exit values</td>
<td align="left">None</td>
</tr>
</tbody>
</table>
<h2 id="escape-jinja-brackets.sh"><span class="header-section-number">16.3</span> <code>escape-jinja-brackets.sh</code></h2>
<p>This script escapes opening Jinja2 template brackets, <code>{#</code>
to avoid internal build problems. Generally, you won't need to run this
script directly.</p>
<table style="width:99%;">
<colgroup>
<col width="30%" />
<col width="68%" />
</colgroup>
<tbody>
<tr class="odd">
<td align="left">Example usage</td>
<td align="left"><code>escape-jinja-brackets.sh file.md</code></td>
</tr>
<tr class="even">
<td align="left">Arguments</td>
<td align="left">1 The file to alter</td>
</tr>
<tr class="odd">
<td align="left">Special exit values</td>
<td align="left">None</td>
</tr>
</tbody>
</table>
<h2 id="inc-headers.sh"><span class="header-section-number">16.4</span> <code>inc-headers.sh</code></h2>
<p>A utility script that increments the headers in a given
markdown file by a given number of levels.</p>
<p>A copy of the original file is kept using the origial
file name and a PID as the extension.</p>
<table style="width:99%;">
<colgroup>
<col width="30%" />
<col width="68%" />
</colgroup>
<tbody>
<tr class="odd">
<td align="left">Example usage</td>
<td align="left"><code>inc-headers.sh file.md 1</code></td>
</tr>
<tr class="even">
<td align="left">Arguments</td>
<td align="left">1 A file to alter.<br />
2 The number of heading levels to increment.</td>
</tr>
<tr class="odd">
<td align="left">Special exit values</td>
<td align="left">None</td>
</tr>
</tbody>
</table>
<h2 id="install_deps_1604_py.sh"><span class="header-section-number">16.5</span> <code>install_deps_1604+_py.sh</code></h2>
<p>This script will install all MkTechDocs dependencies in an Ubuntu
16.04 environment. It is not currently suited for using in a
docker container or vagrantfile, although it would be easy enough
to adapt it for such use.</p>
<table style="width:99%;">
<colgroup>
<col width="30%" />
<col width="68%" />
</colgroup>
<tbody>
<tr class="odd">
<td align="left">Example usage</td>
<td align="left"><code>install_deps_1604+_py.sh</code></td>
</tr>
<tr class="even">
<td align="left">Arguments</td>
<td align="left">None</td>
</tr>
<tr class="odd">
<td align="left">Special exit values</td>
<td align="left">None</td>
</tr>
</tbody>
</table>
<h2 id="install_deps_arch_py.sh"><span class="header-section-number">16.6</span> <code>install_deps_arch_py.sh</code></h2>
<p>This script will install all MkTechDocs dependencies in an Arch
environment. It is not currently suited for using in a
docker container or vagrantfile, although it would be easy enough
to adapt it for such use.</p>
<table style="width:99%;">
<colgroup>
<col width="30%" />
<col width="68%" />
</colgroup>
<tbody>
<tr class="odd">
<td align="left">Example usage</td>
<td align="left"><code>install_deps_arch_py.sh</code></td>
</tr>
<tr class="even">
<td align="left">Arguments</td>
<td align="left">None</td>
</tr>
<tr class="odd">
<td align="left">Special exit values</td>
<td align="left">None</td>
</tr>
</tbody>
</table>
<h2 id="install_deps_macos_py.sh"><span class="header-section-number">16.7</span> <code>install_deps_macos_py.sh</code></h2>
<p>This script will install all MkTechDocs dependencies in a macOS
environment. It is not currently suited for using in a
docker container or vagrantfile, although it would be easy enough
to adapt it for such use.</p>
<table style="width:99%;">
<colgroup>
<col width="30%" />
<col width="68%" />
</colgroup>
<tbody>
<tr class="odd">
<td align="left">Example usage</td>
<td align="left"><code>install_deps_macos_py.sh</code></td>
</tr>
<tr class="even">
<td align="left">Arguments</td>
<td align="left">None</td>
</tr>
<tr class="odd">
<td align="left">Special exit values</td>
<td align="left">None</td>
</tr>
</tbody>
</table>
<h2 id="mktechdocs"><span class="header-section-number">16.8</span> <code>mktechdocs</code></h2>
<h1 id="addendum"><span class="header-section-number">17</span> Addendum</h1>
<h2 id="understanding-the-build-process"><span class="header-section-number">17.1</span> Understanding the build process</h2>
<p>The MkTechDocs build process is complex. The following is a step-by-step guide towards understanding how it works.</p>
<ol style="list-style-type: decimal">
<li>MkTechDocs consists of a BASH control script and a library of Python and Groovy filters.</li>
<li>The control script is responsible for importing the project configuration and calling <code>pandoc</code> with the correct arguments to build reasonably formatted documents in a variety of formats.</li>
<li>The &quot;magic&quot; behind it all is <code>pandoc</code> 's Abstract Syntax Tree (AST). Internally, <code>pandoc</code> converts all documents into AST, which can then be converted to JSON, which can then be manipulated by filters.</li>
<li>MkTechDocs exploits this with a couple of libraries, <a href="https://github.com/jsseidel/groovy-pandoc">GroovyPandoc</a>, for Groovy template integration, and <a href="https://github.com/jgm/pandocfilters">PandocFilters</a>, for Python integration.</li>
<li>Every time you run <code>mktechdocs</code>, the control script calls <code>pandoc</code> on your project's master document. Some Bash scripting then takes care of some little details, which you can see for yourself by examining the script.</li>
</ol>
<h2 id="contact"><span class="header-section-number">17.2</span> Contact</h2>
<p>MkTechDocs was built and is maintained by <a href="http://www.spencerseidel.com">Spencer Seidel</a>.</p>
<h1 id="document-change-log"><span class="header-section-number">18</span> Document change log</h1>
<p>
<p><strong>Date</strong>: Fri Jul 6 10:31:15 2018 -0400<br />
<strong>Author</strong>: jsseidel <a href="mailto:jsseidel@fastmail.com">jsseidel@fastmail.com</a><br />
<strong>Message</strong>: Added section about how to escape curly brackets [doc]
<br /></p>
<p>
<p><strong>Date</strong>: Thu Jul 5 15:03:43 2018 -0400<br />
<strong>Author</strong>: jsseidel <a href="mailto:jsseidel@fastmail.com">jsseidel@fastmail.com</a><br />
<strong>Message</strong>: Updated to point to tutorial MkTechDocs project [doc]
<br /></p>
<p>
<p><strong>Date</strong>: Thu Jul 5 11:15:26 2018 -0400<br />
<strong>Author</strong>: jsseidel <a href="mailto:jsseidel@fastmail.com">jsseidel@fastmail.com</a><br />
<strong>Message</strong>: Added section for doing docker builds [doc]
<br /></p>
<p>
<p><strong>Date</strong>: Mon May 21 12:26:48 2018 -0400<br />
<strong>Author</strong>: jsseidel <a href="mailto:jsseidel@fastmail.com">jsseidel@fastmail.com</a><br />
<strong>Message</strong>: Added a 'doesn't work' note to the section about plantuml images titles. [doc]
<br /></p>
<p>
<p><strong>Date</strong>: Mon May 21 11:41:47 2018 -0400<br />
<strong>Author</strong>: jsseidel <a href="mailto:jsseidel@fastmail.com">jsseidel@fastmail.com</a><br />
<strong>Message</strong>: Added bit about 18.04 and cleaned up some wording [doc]
<br /></p>
<p>
<p><strong>Date</strong>: Tue Apr 24 15:58:05 2018 -0400<br />
<strong>Author</strong>: jsseidel <a href="mailto:jsseidel@fastmail.com">jsseidel@fastmail.com</a><br />
<strong>Message</strong>: Updated version to 1.0 and reset document change log [doc]
<br /></p>
<p>
<p><strong>Date</strong>: Tue Apr 24 15:13:25 2018 -0400<br />
<strong>Author</strong>: jsseidel <a href="mailto:jsseidel@fastmail.com">jsseidel@fastmail.com</a><br />
<strong>Message</strong>: Changed build system to remove makefile and updated documentation [doc]
<br /></p>
</div><!-- content -->
<div id="footer">
<div style="text-align: center ; border-top: 1px solid #dddddd ; padding: 2px 2px ; "><p>Copyright &copy; 2018 AT&T Intellectual Property. All rights reserved.</p></div>


</div><!-- footer -->
</div><!-- wrapper -->
</body>
</html>
